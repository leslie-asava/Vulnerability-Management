import json
  
# Opening JSON file
f = open('software_list.json')
  
# returns JSON object as 
data = json.load(f)

software_list = data["programs"]

# Opening JSON file
f = open('parsed_exploits.json')
  
data = json.load(f)

vulnerability_list = data

# Closing file
f.close()

excluded = ["-", "for"]

reported = []

for vulnerability in vulnerability_list:
    description = vulnerability["cve_description"]
    cve_id = vulnerability["cve_id"]
    description = description[:len(description)-54]
    for program in software_list:
        program_name = program["name"]
        program_version = program["version"]
        program_split = program_name.split(" ")
        found = False
        for word in program_split:
            if (word and word in description and word not in excluded and not word.isdigit()):
                #print("'%s'"%word)
                # print("[", word, "]","\n", program_name, "\n" ,description)
                found = True

        if found and program_version in description:
            if cve_id not in reported:
                reported.append(cve_id)

                print("[", program_name, program_version, "]", "\n" ,description)
  